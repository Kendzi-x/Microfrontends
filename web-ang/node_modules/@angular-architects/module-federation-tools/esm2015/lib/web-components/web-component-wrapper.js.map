{"version":3,"file":"web-component-wrapper.js","sourceRoot":"","sources":["../../../../../../libs/mf-tools/src/lib/web-components/web-component-wrapper.ts"],"names":[],"mappings":";AAAA,OAAO,EAAoB,SAAS,EAAE,UAAU,EAAE,KAAK,EAAa,SAAS,EAAE,MAAM,eAAe,CAAC;AACrG,OAAO,EAAE,cAAc,EAAE,MAAM,iBAAiB,CAAC;AACjD,OAAO,EAA2B,gBAAgB,EAAE,MAAM,uCAAuC,CAAC;;;AAUlG,kEAAkE;AAClE,MAAM,OAAO,mBAAmB;IAW9B,YACU,KAAqB;QAArB,UAAK,GAAL,KAAK,CAAgB;IAG7B,CAAC;IAEH,WAAW;QACT,IAAI,CAAC,IAAI,CAAC,OAAO;YAAE,OAAO;QAE1B,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEO,aAAa;QACnB,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE;YAC7B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACvC;IACH,CAAC;IAEO,WAAW;QACjB,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,EAAE;YAC/B,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;SAC1D;IACH,CAAC;IAEK,kBAAkB;;;YAEtB,MAAM,OAAO,GAAG,MAAA,IAAI,CAAC,OAAO,mCAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAkC,CAAC;YAEvF,IAAI;gBACA,MAAM,gBAAgB,CAAC,OAAO,CAAC,CAAC;gBAEhC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;gBAC3D,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,IAAI,CAAC,WAAW,EAAE,CAAC;gBAEnB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aACnD;YACD,OAAM,KAAK,EAAE;gBACT,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aACxB;;KAEF;;gHApDU,mBAAmB;oGAAnB,mBAAmB,6LAEN,UAAU,gEALxB,iBAAiB;2FAGhB,mBAAmB;kBAL/B,SAAS;mBAAC;oBACT,QAAQ,EAAE,gBAAgB;oBAC1B,QAAQ,EAAE,iBAAiB;iBAC5B;qGAKC,EAAE;sBADD,SAAS;uBAAC,IAAI,EAAE,EAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,IAAI,EAAC;gBAGxC,OAAO;sBAAf,KAAK;gBACG,KAAK;sBAAb,KAAK;gBACG,MAAM;sBAAd,KAAK","sourcesContent":["import { AfterContentInit, Component, ElementRef, Input, OnChanges, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { LoadRemoteModuleOptions, loadRemoteModule } from '@angular-architects/module-federation';\r\n\r\nexport type WebComponentWrapperOptions = LoadRemoteModuleOptions & {\r\n    elementName: string;\r\n};\r\n\r\n@Component({\r\n  selector: 'mft-wc-wrapper',\r\n  template: '<div #vc></div>',\r\n})\r\n// eslint-disable-next-line @angular-eslint/component-class-suffix\r\nexport class WebComponentWrapper implements AfterContentInit, OnChanges {\r\n\r\n  @ViewChild('vc', {read: ElementRef, static: true})\r\n  vc: ElementRef;\r\n\r\n  @Input() options: WebComponentWrapperOptions;\r\n  @Input() props: { [prop: string]: unknown };\r\n  @Input() events: { [event: string]: (event: Event) => void };\r\n\r\n  element: HTMLElement;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute) { \r\n\r\n\r\n    }\r\n\r\n  ngOnChanges(): void {\r\n    if (!this.element) return;\r\n\r\n    this.populateProps();\r\n  }\r\n\r\n  private populateProps() {\r\n    for (const prop in this.props) {\r\n      this.element[prop] = this.props[prop];\r\n    }\r\n  }\r\n\r\n  private setupEvents() {\r\n    for (const event in this.events) {\r\n      this.element.addEventListener(event, this.events[event]);\r\n    }\r\n  }\r\n\r\n  async ngAfterContentInit() {\r\n\r\n    const options = this.options ?? this.route.snapshot.data as WebComponentWrapperOptions;\r\n   \r\n    try {\r\n        await loadRemoteModule(options);\r\n\r\n        this.element = document.createElement(options.elementName);\r\n        this.populateProps();\r\n        this.setupEvents();\r\n\r\n        this.vc.nativeElement.appendChild(this.element);\r\n    }\r\n    catch(error) {\r\n        console.error(error);\r\n    }\r\n\r\n  }\r\n\r\n}"]}