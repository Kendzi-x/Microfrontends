{"version":3,"file":"angular-architects-module-federation-tools.js","sources":["../../../../libs/mf-tools/src/lib/web-components/web-component-wrapper.ts","../../../../libs/mf-tools/src/lib/mf-tools.module.ts","../../../../libs/mf-tools/src/lib/utils/global-state.ts","../../../../libs/mf-tools/src/lib/web-components/router-utils.ts","../../../../libs/mf-tools/src/lib/web-components/bootstrap-utils.ts","../../../../libs/mf-tools/src/angular-architects-module-federation-tools.ts"],"sourcesContent":["import { AfterContentInit, Component, ElementRef, Input, OnChanges, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { LoadRemoteModuleOptions, loadRemoteModule } from '@angular-architects/module-federation';\r\n\r\nexport type WebComponentWrapperOptions = LoadRemoteModuleOptions & {\r\n    elementName: string;\r\n};\r\n\r\n@Component({\r\n  selector: 'mft-wc-wrapper',\r\n  template: '<div #vc></div>',\r\n})\r\n// eslint-disable-next-line @angular-eslint/component-class-suffix\r\nexport class WebComponentWrapper implements AfterContentInit, OnChanges {\r\n\r\n  @ViewChild('vc', {read: ElementRef, static: true})\r\n  vc: ElementRef;\r\n\r\n  @Input() options: WebComponentWrapperOptions;\r\n  @Input() props: { [prop: string]: unknown };\r\n  @Input() events: { [event: string]: (event: Event) => void };\r\n\r\n  element: HTMLElement;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute) { \r\n\r\n\r\n    }\r\n\r\n  ngOnChanges(): void {\r\n    if (!this.element) return;\r\n\r\n    this.populateProps();\r\n  }\r\n\r\n  private populateProps() {\r\n    for (const prop in this.props) {\r\n      this.element[prop] = this.props[prop];\r\n    }\r\n  }\r\n\r\n  private setupEvents() {\r\n    for (const event in this.events) {\r\n      this.element.addEventListener(event, this.events[event]);\r\n    }\r\n  }\r\n\r\n  async ngAfterContentInit() {\r\n\r\n    const options = this.options ?? this.route.snapshot.data as WebComponentWrapperOptions;\r\n   \r\n    try {\r\n        await loadRemoteModule(options);\r\n\r\n        this.element = document.createElement(options.elementName);\r\n        this.populateProps();\r\n        this.setupEvents();\r\n\r\n        this.vc.nativeElement.appendChild(this.element);\r\n    }\r\n    catch(error) {\r\n        console.error(error);\r\n    }\r\n\r\n  }\r\n\r\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { WebComponentWrapper } from './web-components/web-component-wrapper';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    WebComponentWrapper\n  ],\n  exports: [\n    WebComponentWrapper\n  ]\n})\nexport class ModuleFederationToolsModule {}\n","export const packageNamespace = '@angular-architects/module-federation-tools';\r\n\r\nfunction getGlobalState<T>(): T {\r\n    const globalState = (window as unknown as { [packageNamespace]: T });\r\n    globalState[packageNamespace] = globalState[packageNamespace] || ({} as unknown as T);\r\n    return globalState[packageNamespace];\r\n}\r\n\r\nexport function getGlobalStateSlice<T>(): T;\r\nexport function getGlobalStateSlice<T, R>(selector: (globalState: T) => R): R;\r\nexport function getGlobalStateSlice<T, R>(\r\n    selector?: (globalState: T) => R\r\n): R | T {\r\n    const globalState = getGlobalState<T>();\r\n    return selector ? selector(globalState) : globalState;\r\n}\r\n\r\nexport function setGlobalStateSlice<T>(slice: T): T {\r\n    return Object.assign(\r\n        getGlobalState<T>(),\r\n        slice\r\n    );\r\n}\r\n","import { Router, UrlMatcher, UrlSegment } from '@angular/router';\r\n\r\nexport function startsWith(prefix: string): UrlMatcher {\r\n    return (url: UrlSegment[]) => {\r\n        const fullUrl = url.map(u => u.path).join('/');\r\n        if (fullUrl.startsWith(prefix)) {\r\n            return ({ consumed: url});\r\n        }\r\n        return null;\r\n    };\r\n}\r\n\r\nexport function endsWith(prefix: string): UrlMatcher {\r\n    return (url: UrlSegment[]) => {\r\n        const fullUrl = url.map(u => u.path).join('/');\r\n        if (fullUrl.endsWith(prefix)) {\r\n            return ({ consumed: url });\r\n        }\r\n        return null;\r\n    };\r\n}\r\n\r\nexport function connectRouter(router: Router, useHash = false): void {\r\n    let url: string;\r\n    if (!useHash) {\r\n        url = `${location.pathname.substr(1)}${location.search}`;\r\n        router.navigateByUrl(url);\r\n        window.addEventListener('popstate', () => {\r\n            router.navigateByUrl(url);\r\n        });\r\n    }\r\n    else {\r\n        url = `${location.hash.substr(1)}${location.search}`;\r\n        router.navigateByUrl(url);\r\n        window.addEventListener('hashchange', () => {\r\n            router.navigateByUrl(url);\r\n        });\r\n    }\r\n}","import { CompilerOptions, enableProdMode, Injector, NgModuleRef, NgZone, PlatformRef, Type, Version } from \"@angular/core\";\r\nimport { platformBrowser } from \"@angular/platform-browser\";\r\nimport { VERSION } from '@angular/core';\r\nimport { getGlobalStateSlice, setGlobalStateSlice } from \"../utils/global-state\";\r\nimport { Router } from \"@angular/router\";\r\nimport { connectRouter } from \"./router-utils\";\r\n\r\nexport type AppType = 'shell' | 'microfrontend';\r\n\r\nexport type Options = {\r\n    production: boolean,\r\n    platformFactory?: () => PlatformRef,\r\n    compilerOptions?: CompilerOptions & BootstrapOptions,\r\n    version?: () => string | Version,\r\n    appType?: AppType;\r\n    /**\r\n     * Opt-out of ngZone sharing.\r\n     * Not recommanded.\r\n     * Default value true.\r\n     */\r\n    ngZoneSharing?: boolean,\r\n    /**\r\n     * Opt-out of platformSharing sharing.\r\n     * Possible, if dependencies are not shared or each bootstrapped\r\n     * remote app uses a different version.\r\n     * Default value true.\r\n     */\r\n    platformSharing?: boolean,\r\n    /**\r\n     * Deactivate support for legacy mode.\r\n     * Only recommanded if all used implementations depend on\r\n     * @angular-architects/module-federation-tools > 13.0.1.\r\n     * Default value true.\r\n     */\r\n    activeLegacyMode?: boolean\r\n};\r\n\r\ndeclare interface BootstrapOptions {\r\n    ngZone?: NgZone | 'zone.js' | 'noop';\r\n    ngZoneEventCoalescing?: boolean;\r\n    ngZoneRunCoalescing?: boolean;\r\n}\r\n\r\nlet ngZoneSharing = true;\r\nlet platformSharing = true;\r\nlet legacyMode = true;\r\n\r\nexport function getMajor(version: string): string {\r\n    const pre = version.match(/\\d+/)[0];\r\n    const post = version.match(/-.*/);\r\n\r\n    if (!pre) {\r\n        throw new Error('Cound not identify major version: ' + version);\r\n    }\r\n\r\n    if (post) {\r\n        return pre + post[0];\r\n    }\r\n\r\n    return pre;\r\n}\r\n\r\n/**\r\n * LEGACY IMPLEMENTATIONS START\r\n *\r\n * Can be deprecated in later major releases.\r\n *\r\n * To increase backwards compatibility legacy and current namespaces\r\n * within the window object are used.\r\n */\r\n\r\nexport type LegacyPlatformCache = {\r\n    platform: Record<string, PlatformRef>;\r\n};\r\n\r\nfunction getLegacyPlatformCache(): LegacyPlatformCache {\r\n    const platformCache = window as unknown as LegacyPlatformCache;\r\n    platformCache.platform = platformCache.platform || {};\r\n    return platformCache;\r\n}\r\n\r\nfunction getLegacyPlatform(key: string): PlatformRef {\r\n    const platform = getLegacyPlatformCache().platform[key];\r\n    /**\r\n     * If dependencies are not shared, platform with same version is different\r\n     * and shared platform will not be returned.\r\n     */\r\n    return platform instanceof PlatformRef ? platform : null;\r\n}\r\n\r\nfunction setLegacyPlatform(key: string, platform: PlatformRef): void {\r\n    getLegacyPlatformCache().platform[key] = platform;\r\n}\r\n\r\nfunction getLegacyNgZone(): NgZone {\r\n    return window['ngZone'];\r\n}\r\n\r\nfunction setLegacyNgZone(zone: NgZone): void {\r\n    window['ngZone'] = zone;\r\n}\r\n\r\n/**\r\n * LEGACY IMPLEMENTATIONS END\r\n */\r\n\r\nfunction getPlatformCache(): Map<Version, PlatformRef> {\r\n    return getGlobalStateSlice(\r\n        (state: { platformCache: Map<Version, PlatformRef> }) => state.platformCache\r\n    ) || setGlobalStateSlice({\r\n        platformCache: new Map<Version, PlatformRef>()\r\n    }).platformCache;\r\n}\r\n\r\nfunction setPlatform(version: Version, platform: PlatformRef): void {\r\n    if (platformSharing) {\r\n      legacyMode && setLegacyPlatform(version.full, platform);\r\n      getPlatformCache().set(version, platform);\r\n    }\r\n}\r\n\r\nfunction getPlatform(options: Options): PlatformRef {\r\n    if (!platformSharing) {\r\n        return options.platformFactory();\r\n    }\r\n\r\n    const versionResult = options.version();\r\n    const version = versionResult === VERSION.full ? VERSION : versionResult;\r\n    const versionKey = typeof version === 'string' ? version : version.full;\r\n\r\n    let platform =\r\n        getPlatformCache().get(version as Version) ||\r\n        (legacyMode && getLegacyPlatform(versionKey));\r\n\r\n    if (!platform) {\r\n        platform = options.platformFactory();\r\n        setPlatform(VERSION, platform);\r\n        options.production && enableProdMode();\r\n    }\r\n\r\n    return platform;\r\n}\r\n\r\nfunction getNgZone(): NgZone {\r\n    return getGlobalStateSlice(\r\n        (state: { ngZone: NgZone }) => state.ngZone\r\n    ) || getLegacyNgZone();\r\n}\r\n\r\nexport function shareNgZone(zone: NgZone): void {\r\n    if (ngZoneSharing) {\r\n      legacyMode && setLegacyNgZone(zone);\r\n      setGlobalStateSlice({ ngZone: zone });\r\n    }\r\n}\r\n\r\nexport function bootstrap<M>(module: Type<M>, options: Options): Promise<NgModuleRef<M>> {\r\n    ngZoneSharing = options.ngZoneSharing !== false;\r\n    platformSharing = options.platformSharing !== false;\r\n    legacyMode = options.activeLegacyMode !== false;\r\n    options.platformFactory = options.platformFactory || (() => platformBrowser());\r\n    options.version = options.version || (() => VERSION);\r\n\r\n    if (ngZoneSharing && !options.compilerOptions?.ngZone) {\r\n        options.compilerOptions = options.compilerOptions || {};\r\n        options.compilerOptions.ngZone = getNgZone();\r\n    }\r\n\r\n    return getPlatform(options).bootstrapModule(module, options.compilerOptions).then(ref => {\r\n\r\n        if (options.appType === 'shell') {\r\n            shareShellZone(ref.injector);\r\n        }\r\n        else if (options.appType === 'microfrontend') {\r\n            connectMicroFrontendRouter(ref.injector);\r\n        }\r\n\r\n        return ref;\r\n    });\r\n}\r\n\r\nfunction shareShellZone(injector: Injector) {\r\n    const ngZone = injector.get(NgZone, null);\r\n    if (!ngZone) {\r\n        console.warn('No NgZone to share found');\r\n        return;\r\n    }\r\n    shareNgZone(ngZone);\r\n}\r\n\r\nfunction connectMicroFrontendRouter(injector: Injector) {\r\n    const router = injector.get(Router);\r\n\r\n    if (!router) {\r\n        console.warn('No router to connect found');\r\n        return;\r\n    }\r\n\r\n    connectRouter(router);\r\n}\r\n\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}